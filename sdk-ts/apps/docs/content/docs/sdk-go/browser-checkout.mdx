---
title: Browser Checkout
description: Opening Stripe checkout in the browser from Go applications
---

# Browser Checkout

The browser checkout flow opens a Stripe-hosted payment page in the user's default browser. This is the recommended approach for first-time purchases.

## Basic Flow

```go
ctx := context.Background()

// 1. Create checkout session and open browser
session, err := sdk.PurchaseInBrowser(ctx, "")
if err != nil {
    log.Fatal(err)
}

fmt.Printf("Complete your purchase at:\n%s\n", session.CheckoutURL)

// 2. Wait for checkout completion (polls every 2 seconds)
result, err := sdk.WaitForCheckoutComplete(ctx, session.SessionID, 0, 0)
if err != nil {
    log.Fatal(err)
}

if result.Valid {
    fmt.Println("Purchase complete! License activated.")
    fmt.Printf("License ID: %s\n", result.License.ID)
} else {
    fmt.Printf("Checkout failed: %s\n", result.Reason)
}
```

## With Email Pre-fill

Pre-fill the email field in Stripe checkout:

```go
session, err := sdk.PurchaseInBrowser(ctx, "user@example.com")
```

## Custom Polling Options

```go
result, err := sdk.WaitForCheckoutComplete(
    ctx,
    session.SessionID,
    3*time.Second,   // Poll every 3 seconds
    5*time.Minute,   // Timeout after 5 minutes
)
```

## Types

### CheckoutSessionResult

```go
type CheckoutSessionResult struct {
    // SessionID for polling
    SessionID string

    // CheckoutURL to open in browser
    CheckoutURL string
}
```

## Manual Browser Control

If you need more control over browser opening:

```go
// Create session without opening browser
session, err := sdk.GetClient().CreateCheckoutSession(
    ctx,
    sdk.config.ProductID,
    "user@example.com",
)

// Open URL yourself
fmt.Printf("Open this URL: %s\n", session.CheckoutURL)

// Or use a custom browser opener
exec.Command("firefox", session.CheckoutURL).Start()
```

## Handling Checkout Status

The SDK polls the checkout status internally, but you can also poll manually:

```go
client := sdk.GetClient()

for {
    status, err := client.GetCheckoutStatus(ctx, session.SessionID)
    if err != nil {
        log.Printf("Poll error: %v", err)
        time.Sleep(2 * time.Second)
        continue
    }

    switch status.Status {
    case "complete":
        // Store the license
        sdk.StoreLicense(status.LicenseKey)
        fmt.Println("Purchase complete!")
        return
    case "expired":
        fmt.Println("Checkout session expired")
        return
    case "pending":
        fmt.Println("Waiting for payment...")
    }

    time.Sleep(2 * time.Second)
}
```

## Context Cancellation

The checkout flow respects context cancellation:

```go
ctx, cancel := context.WithTimeout(context.Background(), 5*time.Minute)
defer cancel()

result, err := sdk.WaitForCheckoutComplete(ctx, session.SessionID, 0, 0)
if err == context.DeadlineExceeded {
    fmt.Println("Checkout timed out")
}
```

## Complete Example

```go
package main

import (
    "context"
    "fmt"
    "log"
    "time"

    tuish "github.com/tuish/sdk-go"
)

func main() {
    sdk, err := tuish.New(tuish.Config{
        ProductID: "prod_xxx",
        PublicKey: "MCowBQYDK2VwAyEA...",
        APIKey:    "sk_live_xxx",
    })
    if err != nil {
        log.Fatal(err)
    }

    ctx := context.Background()

    // Check existing license
    result, _ := sdk.CheckLicense(ctx)
    if result.Valid {
        fmt.Println("Already licensed!")
        return
    }

    // Start purchase
    fmt.Println("No license found. Starting purchase...")
    session, err := sdk.PurchaseInBrowser(ctx, "")
    if err != nil {
        log.Fatal(err)
    }

    fmt.Println("Browser opened. Complete your purchase...")
    fmt.Printf("URL: %s\n", session.CheckoutURL)

    // Wait with progress indicator
    ctx, cancel := context.WithTimeout(ctx, 10*time.Minute)
    defer cancel()

    result, err = sdk.WaitForCheckoutComplete(ctx, session.SessionID, 2*time.Second, 0)
    if err != nil {
        log.Fatal(err)
    }

    if result.Valid {
        fmt.Printf("\nPurchase complete!\n")
        fmt.Printf("License: %s\n", result.License.ID)
        fmt.Printf("Features: %v\n", result.License.Features)
    } else {
        fmt.Printf("\nCheckout failed: %s\n", result.Reason)
    }
}
```

## See Also

- [Terminal Purchase](/docs/sdk-go/terminal-purchase) - For returning customers
- [TypeScript Browser Checkout](/docs/sdk/browser-checkout)
